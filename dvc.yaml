# DVC data processing pipeline

stages:
  download-ruwiki:
    cmd: scripts/download_russian_wiki_dump.sh
    outs:
      - data/ruwiki-latest-pages-articles.xml.bz2
  download-eyo-dicts:
    cmd: scripts/download_eyo_kernel_dicts.sh
    outs:
      - data/not-safe.txt
      - data/safe.txt
  extract-segments-from-wiki:
    cmd: python -m scripts.extract_segments_from_wiki -n ${data.num-segments}
    deps:
      - data/ruwiki-latest-pages-articles.xml.bz2
    outs:
      - data/ruwiki-yo-segments.txt
  prepare-segments-dataset:
    cmd: python -m scripts.prepare_segments_dataset --max-text-length ${data.max-text-length}
    deps:
      - data/ruwiki-yo-segments.txt
    outs:
      - data/ruwiki-yo-segments-preprocessed.csv
  split-dataset:
    cmd: python -m scripts.split_dataset
    deps:
      - data/ruwiki-yo-segments-preprocessed.csv
    outs:
      - data/train.csv
      - data/test.csv
